---
title: 子查询
createTime: 2024/12/19 13:57:18
permalink: /database/5x43quk5/
---

### 1. 子查询的基本使用

- 子查询的基本语法结构：

    ```sql
    SELECT select_list
    FROM table
    WHERE expr operator
    									(SELECT select_list
                       FROM table);
    ```

- 子查询在主查询之前一次执行完成。

- 子查询的结果被主查询使用。

- 注意事项：

  - 子查询要包含在括号内
  - 将子查询放在比较条件的右侧
  - 单行操作符对应单行子查询，多行操作符对应多行子查询

### 2. 子查询的分类

按子查询的结果返回一条还是多条记录分：

- 单行子查询
- 多行子查询

按子查询是否被执行多次分：

- 相关子查询
- 不相关子查询

子查询从数据表中查询了数据结果，如果这个数据结果只执行一次，然后这个数据结果作为主查询的条件进行执行，那么这样的子查询叫做不相关子查询。同样，如果子查询需要执行多次，即采用循环的方式，先从外部查询开始，每次都传入子查询进行查询，然后再将结果反馈给外部，这种嵌套的执行方式就称为相关子查询。

单行子查询比较操作符：

| 操作符 | 含义                     |
| ------ | ------------------------ |
| =      | Equal to                 |
| >      | Greater than             |
| >=     | Greater than or equal to |
| <      | Less than                |
| <=     | Less than or equal to    |
| <>     | Not equal to             |

多行子查询比较操作符：

| 操作符 | 含义                                                     |
| ------ | -------------------------------------------------------- |
| IN     | 等于列表中的任意一个                                     |
| ANY    | 需要和单行比较操作符一起使用，和子查询返回的某一个值比较 |
| ALL    | 需要和单行比较操作符一起使用，和子查询返回的所有值比较   |
| SOME   | 实际上是 ANY 的别名，作用相同，一般常使用 ANY            |

相关子查询

如果子查询的执行依赖于外部查询，通常情况下都是因为子查询中的表用到了外部的表，并进行了条件关联，因此每执行一次外部查询，子查询都要重新计算一次，这样的子查询就称之为关联子查询。

相关子查询按照一行接一行的顺序执行，主查询的每一行都执行一次子查询。

```sql
SELECT column1, column2,...
  FROM table1 outer
WHERE column1 operator
    (SELECT column1, column2
  FROM table2
  WHERE expr1 = outer.expr2);
```

:::tip

在查询语句中，除了在 GROUP BY 和 LIMIT 中不能使用子查询，其他地方都能使用子查询

:::